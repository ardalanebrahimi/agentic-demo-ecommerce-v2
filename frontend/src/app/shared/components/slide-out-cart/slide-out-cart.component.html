@if (open()) {
  <div class="cart-overlay" (click)="close()"></div>
  <div class="cart-panel">
    <div class="cart-header">
      <h2>Cart ({{ cartService.itemCount() }})</h2>
      <button class="close-button" (click)="close()">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <div class="cart-content">
      @if (cartService.cartItems().length === 0) {
        <div class="empty-cart">
          <mat-icon class="empty-icon">shopping_cart</mat-icon>
          <p>Your cart is empty</p>
        </div>
      } @else {
        @for (item of cartService.cartItems(); track item.product.id) {
          <div class="cart-item">
            <div class="item-image">ðŸ“¦</div>
            <div class="item-details">
              <h4 class="item-name">{{ item.product.name }}</h4>
              <p class="item-price">{{ item.product.priceAmount | currency:item.product.priceCurrency }}</p>
              <div class="quantity-controls">
                <button class="qty-btn" (click)="updateQuantity(item.product.id, -1)">
                  <mat-icon>remove</mat-icon>
                </button>
                <span class="qty-value">{{ item.quantity }}</span>
                <button class="qty-btn" (click)="updateQuantity(item.product.id, 1)">
                  <mat-icon>add</mat-icon>
                </button>
              </div>
            </div>
            <button class="remove-btn" (click)="removeItem(item.product.id)">
              <mat-icon>close</mat-icon>
            </button>
          </div>
        }
      }
    </div>

    @if (cartService.cartItems().length > 0) {
      <div class="cart-footer">
        <div class="subtotal">
          <span>Subtotal</span>
          <span class="subtotal-amount">{{ cartService.subtotal() | currency:'USD' }}</span>
        </div>
        <a routerLink="/cart" class="checkout-btn" (click)="close()">
          Checkout
        </a>
      </div>
    }
  </div>
}
